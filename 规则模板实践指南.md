# 规则模板实践指南

## 项目概要
这个项目是一个规则模板（rules_template）存储库，主要用于定义和管理AI辅助编码和项目开发的规则和工作流程。其主要功能包括：

1. **AI辅助开发指导框架**：提供了一套全面的规则和工作流程，用于指导AI（如Claude 3.7 Sonnet）在Cursor IDE中进行项目开发。

2. **双模式工作流程**：
   - **PLAN模式（架构模式）**：用于理解需求、制定解决方案策略、验证方案。
   - **ACT模式（编码模式）**：用于实现代码、测试功能、记录变更。

3. **记忆文件系统**：建立了一套基于文件的记忆系统，用于保存项目上下文、架构设计、技术决策和任务计划。核心文件包括：
   - 产品需求文档（product_requirement_docs.md）
   - 架构文档（architecture.md）
   - 技术文档（technical.md）
   - 任务计划（tasks_plan.md）
   - 活动上下文（active_context.md）
   - 错误文档（error-documentation.mdc）
   - 经验教训（lessons-learned.mdc）

4. **特定技术领域规则**：提供了针对不同技术栈的最佳实践和编码标准：
   - LangGraph开发规则：提供使用LangGraph构建AI工作流的最佳实践
   - PyTorch开发规则：提供PyTorch项目的代码组织、性能优化和安全最佳实践
   - MCP服务器开发规则：提供开发Model Context Protocol服务器的协议和步骤

5. **系统化编码协议**：定义了严格的编码流程，包括代码分析、计划、实现和测试的步骤。

6. **自我完善机制**：通过错误文档和经验教训文件，项目可以捕获重要模式、首选项和项目智能，形成一个持续改进的闭环。

7. **规则文件组织标准**：规定了规则文件的存放位置和命名规范，确保项目结构的一致性。

8. **目录结构规范**：定义了项目的标准目录结构，包括docs/、tasks/、src/、test/等关键目录。

这个项目本质上是一个元级别的框架，旨在规范和优化AI辅助开发过程，特别是在使用Cursor IDE和Claude等大型语言模型进行开发时。它不是一个具体的应用程序，而是一个用于指导开发过程的规则和最佳实践集合，可以应用于各种开发项目中。


## 各阶段模型选择（参考）
- PLAN MODE：使用Gemini 2.5 pro模型
- ACT MODE： 使用Claude-3.7 R 模型

## 使用技巧
### 1. PLAN 阶段
- 聊天模式：chat/Agent
- 目标：明确需求，并在一开始就尽可能多地澄清问题。所有需求都应尽可能精确和详细，以便节省后续重做的时间和精力。
- 实践：
    - 提出需求
        ```bash
        # 提示词
        我需要开发一个大模型token计量的后端系统，主要功能包括：
        1. 统计LLM ASR TTS IMAGE 视频的token用量
        2. 提供grpc接口并将内容存储到SQLite数据库
        3. 提供按epoch查询token用量接口

        请严格遵循@plan.mdc @memory.mdc 规则，帮我规划这个项目的架构设计和技术选型。
        请参考@directory-structure.mdc 规则，帮我设计目录结构。
        ```
    - 澄清问题
        ```bash
        # AI会要求澄清问题，根据问题进行回复，比如：
        我们现在开始对需求进行澄清并确定一些技术选型：
        1. Token 定义：LLM使用模型自带的分词表进行计算，ASR使用输入的音频时长（ms），TTS按照输入文本的字符数（英文1个 中文2个），图像使用像素的长*宽*生图数量，我不确定视频怎么计算token，你可以帮我选型下，必要时可以调用工具进行网络搜索
        2. Epoch 定义：固定的时间窗口,每小时
        3. 数据来源与格式：业务端产生并上报，格式你定
        4. 预期负载:  100qps
        5. 查询需求: 你定
        6. 认证与授权：不需要，因为是内部进程调用
        7. 不确定的问题请通过<WEB USE>进行搜索，获取最佳的5种示例
        ```
    - 继续澄清，直到所有需求都精确和详细
    - 用户验证AI制定的最佳计划

### 2. ACT 阶段
- 聊天模式：Agent
- 目标：完成编码，遵循关注点分离、模块化设计和增量开发等概念。以迭代的方式实施拟议的计划，一次实现一个功能，并对所有用例进行详尽的测试。然后构建下一个功能。通过这种方式，确保系统稳健且持续改进。
- 实践：
    ```bash
    # 提示词
    请严格按照以下流程实现代码：

    1. 【强制性步骤】读取并理解 @memory.mdc 和 @implement.mdc 规则文件
    - 在开始任何编码前，请确认你已完全理解这些规则

    2. 【强制性步骤】对于每个任务，必须先执行SYSTEMATIC CODE PROTOCOL：
    a. 分析阶段：
        - 明确进行依赖分析
        - 执行完整的流程分析
        - 在继续前必须记录这些分析结果
    
    b. 计划阶段：
        - 提供结构化的代码实现方案
        - 解释每部分的作用和影响
    
    c. 实现阶段：
        - 逐步实现代码
        - 在每个组件完成后立即更新tasks_plan.md（将对应任务标记为已完成）
    
    d. 测试阶段：
        - 为每个实现的组件创建单元测试
        - 测试文件必须放在适当的位置

    3. 【强制性步骤】确认机制：
    - 在每个主要步骤完成后，请明确确认你已遵循规则
    - 使用检查清单确保没有遗漏任何步骤
    - 每个步骤进行前后都要调用MCP Interactive Feedback Rules

    4. 你必须先完成一个任务的所有步骤（包括测试和文档更新），然后再开始下一个任务

    5. 在最终提交前，请回顾并确认已遵循所有规则

    如果你发现自己没有遵循这些步骤，请停止当前操作，回到正确的流程。
    ```
